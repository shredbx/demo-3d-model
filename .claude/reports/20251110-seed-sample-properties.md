# Seed Sample Properties Script - Report

**Date:** 2025-11-10
**Task:** Create seed script for diverse sample properties for semantic search testing
**Script Location:** `/Users/solo/Projects/_repos/bestays/apps/server/scripts/seed_sample_properties.py`

---

## ‚úÖ Deliverable Complete

### Script Created
Created comprehensive seed script with 15 diverse properties covering:
- Multiple property types (villa, house, apartment, condo, townhouse)
- Various locations across Thailand
- Different price points (12,000 - 250,000 THB/month)
- Diverse target audiences and use cases
- Rich semantic descriptions for search testing

---

## üìã Property Inventory (15 Properties)

### 1. Modern Beachfront Villa with Infinity Pool
- **Type:** Villa | **Price:** 150,000 THB/mo | **Priority:** 500 ‚≠ê FEATURED
- **Location:** Phuket, Kamala Beach
- **Tags:** luxury, beach, modern, ocean_view, infinity_pool
- **Description:** Stunning contemporary villa with floor-to-ceiling windows, infinity pool, smart home technology, direct beach access
- **Target:** Luxury travelers, beach lovers

### 2. Cozy Mountain Cabin with Fireplace
- **Type:** House | **Price:** 25,000 THB/mo | **Priority:** 300
- **Location:** Chiang Mai, Samoeng Mountains
- **Tags:** romantic, mountain, quiet, nature, couples, retreat
- **Description:** Intimate wooden cabin with fireplace, private deck, forest trails, stargazing
- **Target:** Couples, romantic getaways

### 3. Pet-Friendly Apartment Near Lumphini Park
- **Type:** Apartment | **Price:** 45,000 THB/mo | **Priority:** 250
- **Location:** Bangkok, Lumphini
- **Tags:** pet_friendly, urban, park_nearby, bangkok, city_living
- **Description:** Spacious apartment near park, pet washing station, veterinary clinics nearby
- **Target:** Pet owners, urban professionals

### 4. Spacious Family Villa with Large Garden
- **Type:** Villa | **Price:** 65,000 THB/mo | **Priority:** 400 ‚≠ê FEATURED
- **Location:** Chiang Mai, Hang Dong
- **Tags:** family_friendly, spacious, garden, kids, safe, schools_nearby
- **Description:** Four-bedroom villa with massive garden, playground, near international schools
- **Target:** Families with children

### 5. Modern Condo with Dedicated Home Office
- **Type:** Condo | **Price:** 38,000 THB/mo | **Priority:** 450 ‚≠ê FEATURED
- **Location:** Bangkok, Sukhumvit
- **Tags:** workspace, modern, digital_nomad, fast_internet, city, coworking
- **Description:** Smart condo with ergonomic workspace, high-speed fiber internet, rooftop pool
- **Target:** Digital nomads, remote workers

### 6. Traditional Thai Teakwood House in Countryside
- **Type:** House | **Price:** 18,000 THB/mo | **Priority:** 200
- **Location:** Nakhon Sawan, Pak Nam Pho
- **Tags:** traditional, rural, authentic, countryside, thai_style, cultural
- **Description:** Authentic teakwood house with traditional architecture, garden with fruit trees
- **Target:** Cultural enthusiasts, rural living

### 7. Luxury Penthouse with 360¬∞ City Views
- **Type:** Condo | **Price:** 250,000 THB/mo | **Priority:** 500 ‚≠ê FEATURED
- **Location:** Bangkok, Silom
- **Tags:** luxury, modern, penthouse, city_views, skyline, exclusive
- **Description:** Top-floor penthouse with panoramic views, Italian marble, private rooftop with jacuzzi
- **Target:** High-net-worth individuals, executives

### 8. Cozy Studio Near University Campus
- **Type:** Apartment | **Price:** 12,000 THB/mo | **Priority:** 150
- **Location:** Bangkok, Wang Mai (near universities)
- **Tags:** affordable, student, urban, compact, university, budget_friendly
- **Description:** Efficient studio with study desk, near universities and public transport
- **Target:** Students, young professionals

### 9. Eco-Friendly Jungle Villa with Solar Power
- **Type:** Villa | **Price:** 42,000 THB/mo | **Priority:** 350
- **Location:** Krabi, Ao Luek
- **Tags:** eco_friendly, sustainable, jungle, nature, off_grid, wildlife
- **Description:** Off-grid villa with solar power, rainwater harvesting, organic gardens
- **Target:** Eco-conscious travelers, nature lovers

### 10. Beachfront Resort Villa with Water Sports Center
- **Type:** Villa | **Price:** 95,000 THB/mo | **Priority:** 380
- **Location:** Chonburi, Pattaya (Na Jomtien)
- **Tags:** beach, active, water_sports, resort, entertainment, sports
- **Description:** Direct beach access with water sports center, beach volleyball, outdoor activities
- **Target:** Active travelers, water sports enthusiasts

### 11. Elegant Villa Overlooking Championship Golf Course
- **Type:** Villa | **Price:** 85,000 THB/mo | **Priority:** 320
- **Location:** Pathum Thani, Khlong Luang
- **Tags:** golf, retirement, leisure, elegant, peaceful, club_access
- **Description:** Sophisticated villa with golf course views, club membership, spa facilities
- **Target:** Golf enthusiasts, retirees

### 12. Executive Serviced Apartment in Business District
- **Type:** Apartment | **Price:** 75,000 THB/mo | **Priority:** 280
- **Location:** Bangkok, Sathon (Business District)
- **Tags:** business, serviced, executive, corporate, convenient, hotel_style
- **Description:** Premium serviced apartment with daily housekeeping, concierge, business center
- **Target:** Business travelers, executives

### 13. Converted Industrial Loft with High Ceilings
- **Type:** Apartment | **Price:** 35,000 THB/mo | **Priority:** 270
- **Location:** Bangkok, Bang Rak (Arts District)
- **Tags:** loft, creative, artist, industrial, high_ceilings, natural_light
- **Description:** Artist's loft with 5-meter ceilings, exposed brick, industrial windows, open plan
- **Target:** Artists, creative professionals

### 14. Tranquil Wellness Retreat Villa with Yoga Studio
- **Type:** Villa | **Price:** 55,000 THB/mo | **Priority:** 340
- **Location:** Surat Thani, Koh Samui
- **Tags:** wellness, yoga, meditation, peaceful, zen, nature, retreat
- **Description:** Zen-inspired villa with yoga studio, meditation garden, water features
- **Target:** Wellness professionals, yoga practitioners

### 15. Restored Sino-Portuguese Shophouse in Old Town
- **Type:** Townhouse | **Price:** 48,000 THB/mo | **Priority:** 290
- **Location:** Phuket, Old Town
- **Tags:** historic, heritage, sino_portuguese, cultural, old_town, restored, unique
- **Description:** Historic shophouse with original tiles, wooden shutters, Portuguese-Chinese design
- **Target:** History buffs, cultural enthusiasts

---

## üéØ Testing Coverage

### Property Types
- **Villa:** 7 properties (beachfront, mountain, jungle, golf, wellness, water sports, family)
- **House:** 2 properties (mountain cabin, traditional Thai)
- **Apartment:** 4 properties (pet-friendly, studio, serviced, loft)
- **Condo:** 2 properties (penthouse, digital nomad workspace)
- **Townhouse:** 1 property (historic shophouse)

### Price Range Distribution
- **Budget (< 30k THB):** 3 properties (12k, 18k, 25k)
- **Mid-range (30-70k THB):** 7 properties
- **High-end (70-100k THB):** 4 properties
- **Luxury (> 100k THB):** 1 property (250k)

### Geographic Coverage
- **Bangkok:** 6 properties (various districts)
- **Chiang Mai:** 2 properties
- **Phuket:** 2 properties (beach, old town)
- **Islands:** 2 properties (Koh Samui, Na Jomtien)
- **Other:** 3 properties (Krabi, Pathum Thani, Nakhon Sawan)

### Target Audiences
- Families with children
- Couples seeking romance
- Digital nomads / remote workers
- Students / young professionals
- Pet owners
- Luxury travelers
- Eco-conscious travelers
- Active / sports enthusiasts
- Business travelers / executives
- Retirees / golf enthusiasts
- Artists / creative professionals
- Wellness seekers / yoga practitioners
- Cultural / history enthusiasts

### Amenity Diversity
- **Pools:** Infinity pool, natural pool, resort pool, rooftop pool
- **Workspaces:** Home office, ergonomic desk, coworking space, business center
- **Nature:** Gardens, mountains, jungle, beach access, hiking trails
- **Sports:** Golf course, water sports, beach volleyball, fitness centers
- **Wellness:** Yoga studio, meditation garden, spa, organic gardens
- **Tech:** Smart home, high-speed internet, solar power
- **Pet-friendly:** Pet washing station, near parks
- **Cultural:** Traditional architecture, heritage features, art district

### Semantic Search Test Queries

The diverse descriptions enable testing with various search queries:

**Lifestyle Queries:**
- "romantic getaway in the mountains"
- "family home with garden for kids"
- "pet-friendly place in the city"
- "peaceful retreat for meditation"
- "beachfront property with water sports"

**Amenity-Based Queries:**
- "home office for remote work"
- "eco-friendly sustainable living"
- "luxury property with pool and ocean view"
- "golf course villa for retirement"
- "creative space with natural light"

**Location + Feature:**
- "quiet mountain cabin with fireplace"
- "beach villa near restaurants"
- "apartment near university"
- "traditional Thai house in countryside"
- "penthouse with city views"

**Budget-Conscious:**
- "affordable studio for students"
- "budget-friendly urban apartment"
- "value for money near public transport"

**Specific Needs:**
- "serviced apartment for business travelers"
- "wellness villa with yoga studio"
- "historic property with cultural charm"
- "off-grid jungle house with solar power"

---

## üìä Data Model Compliance

### PropertyV2 Schema
All properties follow the complete PropertyV2 model structure:

**Core Fields:**
- ‚úÖ title (EN description)
- ‚úÖ description (rich 2-3 sentences for semantic search)
- ‚úÖ transaction_type (all set to "rent")
- ‚úÖ property_type (villa/house/apartment/condo/townhouse)

**Pricing:**
- ‚úÖ rent_price (in satang: THB * 100)
- ‚úÖ currency ("THB")

**Structured Data:**
- ‚úÖ physical_specs (rooms, sizes, floors, year_built, furnishing)
- ‚úÖ location_details (coordinates, administrative, address)
- ‚úÖ amenities (categorized: interior, exterior, building, area)
- ‚úÖ tags (diverse semantic keywords)

**Publication:**
- ‚úÖ is_published (true for all)
- ‚úÖ is_featured (4 properties marked as featured)
- ‚úÖ listing_priority (150-500 range)

**Audit:**
- ‚úÖ created_by (set to first user in database)

---

## üöÄ How to Run

### Prerequisites
1. Docker must be running
2. Database must be initialized (migrations applied)
3. At least one user must exist in database

### Execution Steps

**Step 1: Start Docker Services**
```bash
cd /Users/solo/Projects/_repos/bestays
make up
```

**Step 2: Run Seed Script**
```bash
docker exec -i bestays-server-dev python scripts/seed_sample_properties.py
```

**Expected Output:**
```
üìù Using user <email> (ID: X) as creator

‚úÖ Successfully seeded 15 diverse properties!

üìã Property Summary:
================================================================================
 1. Modern Beachfront Villa with Infinity Pool          ‚≠ê FEATURED
    Type: VILLA        Price: 150,000 THB/mo  Priority: 500
    Tags: luxury, beach, modern, ocean_view, infinity_pool
    ID: <uuid>

 2. Cozy Mountain Cabin with Fireplace
    ...

[15 properties listed with details]
================================================================================

üéØ Testing Coverage:
   - Property types: villa, house, apartment, condo, townhouse
   - Locations: Phuket, Chiang Mai, Bangkok, Krabi, Pattaya, Koh Samui, Nakhon Sawan
   - Price range: 12,000 - 250,000 THB/month
   - Target audiences: families, couples, students, digital nomads, retirees, etc.
   - Amenities: pools, gardens, workspace, pet-friendly, beach access, etc.
   - Tags: luxury, budget, eco, wellness, traditional, modern, etc.

üí° Next Steps:
   1. Generate embeddings: python scripts/backfill_property_embeddings.py
   2. Test semantic search with queries like:
      - 'romantic getaway in the mountains'
      - 'family home with garden for kids'
      - 'beach villa with water sports'
      - 'quiet place for remote work'
```

**Step 3: Verify Properties Created**
```bash
docker exec -i bestays-server-dev python -c "
import asyncio
from sqlalchemy import select, func
from server.core.database import AsyncSessionLocal
from server.models.property_v2 import PropertyV2

async def check():
    async with AsyncSessionLocal() as db:
        result = await db.execute(select(func.count(PropertyV2.id)))
        count = result.scalar()
        print(f'Total properties: {count}')

        result = await db.execute(select(PropertyV2).limit(5))
        properties = result.scalars().all()
        print(f'\nFirst 5 properties:')
        for p in properties:
            print(f'- {p.title[:50]}... (ID: {p.id})')

asyncio.run(check())
"
```

**Step 4: Generate Embeddings (Required for Semantic Search)**
```bash
docker exec -i bestays-server-dev python scripts/backfill_property_embeddings.py
```

---

## üîç Verification Queries

### Check Property Count by Type
```sql
SELECT property_type, COUNT(*)
FROM properties
GROUP BY property_type
ORDER BY COUNT(*) DESC;
```

### Check Featured Properties
```sql
SELECT title, rent_price/100 as price_thb, listing_priority
FROM properties
WHERE is_featured = true
ORDER BY listing_priority DESC;
```

### Check Tag Distribution
```sql
SELECT unnest(tags) as tag, COUNT(*)
FROM properties
GROUP BY tag
ORDER BY COUNT(*) DESC
LIMIT 20;
```

### Check Price Range
```sql
SELECT
  MIN(rent_price/100) as min_price,
  MAX(rent_price/100) as max_price,
  AVG(rent_price/100) as avg_price,
  PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY rent_price/100) as median_price
FROM properties;
```

---

## üé® Design Decisions

### Why These 15 Properties?

**1. Diverse Use Cases**
Each property targets a different persona or need:
- Luxury seekers (penthouse, beachfront villa)
- Budget-conscious (student studio, traditional house)
- Lifestyle-specific (digital nomad, pet owners, families)
- Activity-focused (water sports, golf, wellness)
- Cultural enthusiasts (historic shophouse, traditional Thai)

**2. Rich Semantic Content**
Descriptions use natural language patterns that users would search for:
- Emotional language ("romantic", "peaceful", "vibrant")
- Activity descriptions ("stargazing", "water sports", "meditation")
- Sensory details ("misty mountains", "turquoise horizon", "golden teakwood")
- Target audience indicators ("perfect for families", "digital nomad paradise")

**3. Geographic Diversity**
Covers popular Thai destinations:
- Major cities (Bangkok - 6 properties)
- Tourist islands (Phuket, Koh Samui)
- Northern Thailand (Chiang Mai)
- Southern beaches (Krabi, Pattaya)
- Rural areas (Nakhon Sawan)

**4. Price Point Distribution**
Ensures testing across price ranges:
- Budget: 12k-25k (3 properties)
- Mid-range: 35k-65k (7 properties)
- High-end: 75k-95k (4 properties)
- Ultra-luxury: 250k (1 property)

**5. Amenity Coverage**
Tests different amenity combinations:
- Water features (pools, beach, ocean)
- Work amenities (office, internet, coworking)
- Nature elements (gardens, mountains, jungle)
- Sports facilities (golf, water sports, fitness)
- Wellness features (yoga studio, meditation garden)
- Pet-friendly facilities
- Cultural/historic elements

---

## ‚úÖ Script Features

### Safety Checks
- ‚úÖ Checks if properties already exist (skips if found)
- ‚úÖ Validates user exists before seeding
- ‚úÖ Uses async/await properly
- ‚úÖ Transaction management (commit on success)
- ‚úÖ Clear error messages

### Data Quality
- ‚úÖ All required fields populated
- ‚úÖ Realistic Thailand coordinates
- ‚úÖ Proper price conversion (THB ‚Üí satang)
- ‚úÖ Structured JSONB fields
- ‚úÖ Appropriate furnishing levels
- ‚úÖ Realistic year_built values
- ‚úÖ Valid property types

### Usability
- ‚úÖ Detailed console output
- ‚úÖ Property summary with key info
- ‚úÖ Testing suggestions
- ‚úÖ Next steps guidance
- ‚úÖ Clear emoji indicators
- ‚úÖ Formatted table output

---

## üìù Next Steps

### 1. Run the Seed Script
Start Docker and execute the script (see "How to Run" section)

### 2. Generate Embeddings
Run the embedding backfill script to enable semantic search:
```bash
docker exec -i bestays-server-dev python scripts/backfill_property_embeddings.py
```

### 3. Test Semantic Search
Try various search queries via the API:
```bash
curl -X POST http://localhost:8011/api/v1/properties/semantic-search \
  -H "Content-Type: application/json" \
  -d '{"query": "romantic mountain getaway", "limit": 5}'
```

### 4. Validate Results
Check that semantic search returns relevant properties:
- "romantic mountain getaway" ‚Üí Should return mountain cabin
- "family home with garden" ‚Üí Should return family villa
- "quiet place for remote work" ‚Üí Should return digital nomad condo
- "beach villa with water sports" ‚Üí Should return resort villa
- "pet-friendly urban apartment" ‚Üí Should return Lumphini apartment

### 5. Monitor Performance
Check search response times and relevance scores

---

## üìå Files Modified

### Created
- `/Users/solo/Projects/_repos/bestays/apps/server/scripts/seed_sample_properties.py`
  - 550+ lines of comprehensive seed script
  - 15 diverse properties with rich descriptions
  - Safety checks and validation
  - Detailed console output and guidance

---

## üéØ Success Criteria

- ‚úÖ Script created with 15 diverse properties
- ‚úÖ All properties have rich semantic descriptions (2-3 sentences)
- ‚úÖ Mix of property types (villa, condo, apartment, house, townhouse)
- ‚úÖ Various locations across Thailand
- ‚úÖ Different amenities and target audiences
- ‚úÖ Variety of tags for semantic search testing
- ‚úÖ Price range from budget to luxury (12k - 250k THB)
- ‚úÖ Safety checks (existing properties, user validation)
- ‚úÖ Proper schema compliance (PropertyV2 model)
- ‚úÖ Executable script with clear instructions

---

## üèÅ Conclusion

The seed script is complete and ready to populate the database with diverse sample properties. The 15 properties cover:

- ‚úÖ **5 property types** (villa, house, apartment, condo, townhouse)
- ‚úÖ **7 Thai locations** (Bangkok, Chiang Mai, Phuket, Krabi, etc.)
- ‚úÖ **13 target audiences** (families, couples, students, digital nomads, etc.)
- ‚úÖ **25+ amenity categories** (pools, workspace, beach, mountain, etc.)
- ‚úÖ **40+ unique tags** for semantic search diversity
- ‚úÖ **Price range 12k-250k THB** (budget to ultra-luxury)

Once executed, these properties will provide an excellent dataset for testing semantic search functionality across diverse user queries and use cases.

**Status:** ‚úÖ READY TO RUN (Docker must be started first)
